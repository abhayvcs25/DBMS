create database supplier;
use supplier;

CREATE TABLE Supplier (
    sid INT PRIMARY KEY,
    sname VARCHAR(50),
    city VARCHAR(50)
);

CREATE TABLE Parts (
    pid INT PRIMARY KEY,
    pname VARCHAR(50),
    color VARCHAR(20)
);

CREATE TABLE Catalog (
    sid INT,
    pid INT,
    cost DECIMAL(10,2),
    PRIMARY KEY (sid, pid),
    FOREIGN KEY (sid) REFERENCES Supplier(sid),
    FOREIGN KEY (pid) REFERENCES Parts(pid)
);


INSERT INTO Supplier VALUES
(1, 'Acme Widget Suppliers', 'New York'),
(2, 'Global Parts Co', 'London'),
(3, 'Fasteners Ltd', 'Delhi');

INSERT INTO Parts VALUES
(101, 'Bolt', 'Red'),
(102, 'Nut', 'Blue'),
(103, 'Screw', 'Red'),
(104, 'Washer', 'Green');

INSERT INTO Catalog VALUES
(1, 101, 12.00),
(1, 102, 15.00),
(2, 101, 10.00),
(2, 103, 20.00),
(3, 103, 25.00),
(3, 104, 18.00);

SELECT DISTINCT P.pname
FROM Parts P
JOIN Catalog C ON P.pid = C.pid;


SELECT S.sname
FROM Supplier S
WHERE NOT EXISTS (
    SELECT P.pid
    FROM Parts P
    WHERE P.color = 'Red'
      AND P.pid NOT IN (
          SELECT C.pid
          FROM Catalog C
          WHERE C.sid = S.sid
      )
);

SELECT P.pname
FROM Parts P
JOIN Catalog C ON P.pid = C.pid
JOIN Supplier S ON S.sid = C.sid
WHERE S.sname = 'Acme Widget Suppliers'
  AND P.pid NOT IN (
      SELECT C2.pid
      FROM Catalog C2
      JOIN Supplier S2 ON C2.sid = S2.sid
      WHERE S2.sname <> 'Acme Widget Suppliers'
  );


SELECT DISTINCT C.sid
FROM Catalog C
WHERE C.cost > (
    SELECT AVG(C2.cost)
    FROM Catalog C2
    WHERE C2.pid = C.pid
);


SELECT P.pname, S.sname
FROM Parts P
JOIN Catalog C ON P.pid = C.pid
JOIN Supplier S ON S.sid = C.sid
WHERE C.cost = (
    SELECT MAX(C2.cost)
    FROM Catalog C2
    WHERE C2.pid = P.pid
);
